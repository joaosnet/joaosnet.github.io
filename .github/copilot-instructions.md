# GitHub Copilot Instructions for joaosnet.github.io

## Project Overview
This is a personal portfolio website hosted on GitHub Pages. It uses a static HTML/CSS/JS architecture with a Python automation script to dynamically update project listings from GitHub.

## Architecture & Key Components
- **Frontend**: Vanilla HTML5, CSS3 (SCSS), and JavaScript. No framework (React/Vue/etc.) is used for the runtime site.
- **Structure**: Modular architecture with separated concerns - HTML (structure), CSS (presentation), and JavaScript (6 specialized modules).
- **Automation**: `update_projects.py` is the core automation engine. It fetches repository data from the GitHub API and injects HTML into `index.html`. Supports both public and private repositories (with authentication).
- **Styling**: Uses CSS variables for theming (Light/Dark mode). Styles are now separated into `assets/css/styles.css` with SCSS source files in `assets/sass/` for maintainability.
- **Assets**: Located in `assets/`:
  - **CSS**: 
    - `assets/css/styles.css` - Main stylesheet (modularized, ~1000 lines)
    - `assets/css/main.css` - Compiled from SCSS (legacy)
    - `assets/css/noscript.css` - No-JavaScript fallbacks
    - `assets/css/fontawesome-all.min.css` - FontAwesome icons
  - **JavaScript** (6 specialized modules):
    - `assets/js/theme-manager.js` - Light/dark theme toggling (class ThemeManager)
    - `assets/js/mobile-menu.js` - Mobile menu handling (class MobileMenuHandler)
    - `assets/js/animations.js` - Scroll animations and observers (class AnimationsHandler)
    - `assets/js/contact-form.js` - Form submission and FAB (class ContactFormHandler)
    - `assets/js/utils.js` - Particles, floating shapes, and view counter (FloatingShapesHandler, ViewsCounter, initParticles)
    - `assets/js/geo-counter.js` - Visitor tracking (class GeoViewsCounter) - collects IP, geolocation, timestamp, user-agent
    - `assets/js/theme.js` - Legacy theme handling (kept for compatibility)
  - `assets/sass/` - SCSS source files (main.scss, noscript.scss, libs/ with _breakpoints.scss, _functions.scss, _mixins.scss, _vars.scss, _vendor.scss)
  - `assets/project-images/` - Downloaded images from private repositories
  - `assets/webfonts/` - FontAwesome webfonts

## Critical Workflows
- **Updating Projects**:
  - Run `python update_projects.py` to fetch repositories (both public and private) and update `index.html`.
  - **Requirements**: Set either `PRIVATE_REPOS_TOKEN` (preferred) or `GITHUB_TOKEN` environment variable to avoid API rate limits and access private repositories.
  - **Mechanism**: 
    - The script looks for `<!-- PROJECTS_START -->` and `<!-- PROJECTS_END -->` markers in `index.html`. **Do not remove these markers.**
    - Fetches up to 100 repositories with affiliation filter (owner, collaborator, organization_member)
    - Selects top 4 projects (prioritizing organization repos up to 2, then owner repos)
    - Extracts preview images from README files or uses social preview/avatar as fallback
    - For private repos with relative image paths, downloads images locally to `assets/project-images/`
    - Generates alternating left/right timeline layout with metadata (updated date, description)
  - **Output**: Timeline-style HTML with alternating left/right card layout and a central vertical line

- **Theme Management**:
  - Themes are controlled via the `data-theme` attribute on the `<html>` tag (`light` or `dark`).
  - CSS variables (e.g., `--primary`, `--secondary`, `--bg-card`) are defined in the `<style>` block in `index.html`.
  - Theme state is persisted in `localStorage` as `theme`.
  - Logic resides in `assets/js/theme.js` and toggles via a button with FontAwesome icons.
  - Default theme is dark unless user has previously selected light mode.

## Code Conventions & Patterns
- **Language**: The site content is in Portuguese (pt-br).
- **Visitor Tracking System** (Google Drive Analytics):
  - **Architecture**: Collects visitor data (IP, geolocation, timestamp, user-agent) via frontend and stores privately in Google Sheets
  - **Frontend Component**: `assets/js/geo-counter.js` (class GeoViewsCounter)
    - Collects: IP via ip-api.com, country, city, ISP, timestamp (ISO), user-agent, URL, referrer
    - Sends on every visit async (non-blocking with keepalive: true)
    - Stores in localStorage for last 7 days (~5-10MB max)
    - Rate limiting: 1 hour between sends per IP
    - Error handling: graceful fallbacks, never breaks site
  - **Backend Component**: Google Apps Script Web App (code in `GOOGLE_APPS_SCRIPT_CODE.gs`)
    - Function `doPost(e)`: receives visitor data JSON
    - Function `appendVisitToSheet(data)`: writes to "Visitas" aba with headers
    - Function `updateStatistics()`: calculates Top 10 countries/cities in "Estat√≠sticas" aba
    - Automatic table creation on first run
  - **Setup**: User must: create Google Sheet "Portfolio Analytics", create Apps Script, deploy as Web App, paste URL into geo-counter.js
    - Documentation: `SETUP_GOOGLE_DRIVE_TRACKING.md` (detailed), `QUICK_START.md` (5 min)
  - **Privacy**: Data completely private (never exposed publicly), LGPD compliant, only you access (secure with Google Drive permissions)
  - **Display**: Counter in footer styled with gradient, icon üëÅ, number updated yearly per localStorage
  - **Related Files**: Assets/css/styles.css has `.views-counter` styling (gradient background, shadow, hover effect)
- **HTML Structure**:
  - `index.html` is now lean (~434 lines) containing only semantic HTML structure.
  - All styles are referenced from `assets/css/styles.css`.
  - All JavaScript is loaded via 6 modular scripts in the correct order.
  - The `<!-- PROJECTS_START -->` and `<!-- PROJECTS_END -->` markers must be preserved for `update_projects.py`.
- **CSS Architecture**:
  - **Main file**: `assets/css/styles.css` (~1000 lines, organized by sections):
    - Variables & Theme Configuration
    - Base Styles & Typography
    - Header & Navigation
    - Hero Section
    - Buttons (primary, secondary, loading states)
    - Floating Shapes & Animations
    - Features Grid
    - Specs Section (Projects timeline)
    - CTA & Contact Section
    - Footer
    - Floating Action Button (FAB)
    - Animations & Keyframes
    - Responsive Design (mobile-first)
  - Uses CSS variables for theming:
    - Dark mode (default): `--primary: #3b82f6`, `--secondary: #8b5cf6`, `--accent: #06b6d4`, etc.
    - Light mode: Override via `html[data-theme="light"]`
  - No inline styles in HTML (except data attributes).
- **JavaScript Modules** (5 specialized modules):
  - **`theme-manager.js`** (Class: ThemeManager)
    - Methods: `getCurrentTheme()`, `toggleTheme()`, `applyTheme(theme)`, `updateToggleIcon(theme)`
    - Handles theme persistence via localStorage
    - Initializes on `DOMContentLoaded`
  - **`mobile-menu.js`** (Class: MobileMenuHandler)
    - Methods: `toggleMenu()`, `closeMenu()`
    - Manages `.menu-open` class on body
    - Handles overlay clicks and nav link clicks
    - Initializes on `DOMContentLoaded`
  - **`animations.js`** (Class: AnimationsHandler)
    - Methods: `setupScrollAnimations()`, `setupHeaderScrollEffect()`, `setupSmoothScrolling()`
    - IntersectionObserver for `.hidden` and `.timeline-item-*` elements
    - Smooth scroll for anchor links
    - Header scroll state management
    - Initializes on `DOMContentLoaded`
  - **`contact-form.js`** (Class: ContactFormHandler)
    - Methods: `handleSubmit()`, `openMailClient()`, `copyEmailToClipboard()`, `openGmail()`, `scrollToForm()`, `showToast()`
    - Form submission to Formspree with fallback behavior
    - Toast notifications with auto-hide
    - FAB smooth scroll and focus
    - Email utilities (copy, open in client, Gmail)
    - Initializes on `DOMContentLoaded`
  - **`utils.js`** (Multiple utilities)
    - Class: FloatingShapesHandler - Mouse move tracking for floating shapes
    - Class: ViewsCounter - localStorage-based view counter (yearly)
    - Function: initParticles() - particles.js configuration
    - All initialize on `DOMContentLoaded`
  - **`geo-counter.js`** (Class: GeoViewsCounter)
    - Methods: `collectAndSendGeoData()`, `fetchGeoData()`, `storeVisitData()`, `sendToGoogleAppsScript()`, `cleanOldData()`, `getStoredData()`, `getLocalStatistics()`
    - Collects IP, country, city, ISP, timestamp, user-agent
    - Sends async to Google Apps Script (non-blocking)
    - Stores in localStorage with 7-day retention
    - Rate limiting (1 hour per IP)
    - Initializes on `DOMContentLoaded`
- **HTML Injection** (via update_projects.py):
  - The script looks for `<!-- PROJECTS_START -->` and `<!-- PROJECTS_END -->` markers. **Do not remove these.**
  - Fetches up to 100 repositories with affiliation filter (owner, collaborator, organization_member).
  - Selects top 4 projects (prioritizing organization repos up to 2, then owner repos).
  - Extracts preview images from README files or uses social preview/avatar as fallback.
  - For private repos with relative image paths, downloads images to `assets/project-images/`.
  - Generates alternating left/right timeline layout (grid-based) with metadata (updated date, description).
  - Output: Timeline-style HTML with 3-column grid (content | dot | empty or empty | dot | content).
- **Contact Form**:
  - Uses Formspree (`https://formspree.io/f/mdoqyljj`) with POST method.
  - Includes fallbacks: on fetch error, opens mailto link or Gmail compose.
  - Form fields: `name`, `email`, `message` (all plaintext).
  - Success toast message: "Mensagem enviada com sucesso! Obrigado."
  - Form resets after successful submission; submit button shows temporary "Enviado! ‚úì" state.
- **External Libraries**:
  - `particles.js` (v2.0.0) for background effects (loaded via CDN).
  - FontAwesome 6.4.0 for icons (via CDN).
  - Google Fonts: Outfit (body text, sans-serif) and Space Grotesk (headings, monospace).
  - View counter: 100% localStorage-based (no external API).
- **JavaScript Patterns**:
  - All modules use vanilla DOM API (no jQuery or frameworks).
  - Classes are used for organization; auto-initialize on `DOMContentLoaded`.
  - Toast notifications via `showToast()` helper with auto-hide after 3.5 seconds.
  - FAB smoothly scrolls to contact form and focuses message field.
  - Theme persistence uses `localStorage.setItem('theme', theme)`.
  - Load order matters: particles.js ‚Üí utils.js ‚Üí geo-counter.js ‚Üí theme-manager.js ‚Üí mobile-menu.js ‚Üí animations.js ‚Üí contact-form.js.

## Development Guidelines
- **CSS**: 
  - All CSS is now centralized in `assets/css/styles.css`.
  - Prefer using the defined CSS variables for colors to ensure dark/light mode compatibility.
  - Main variables:
    - Dark mode (default): `--primary: #3b82f6`, `--secondary: #8b5cf6`, `--dark: #020617`, `--light: #f8fafc`, `--accent: #06b6d4`
    - Light mode: `--primary: #1d4ed8`, `--secondary: #7c3aed`, `--dark: #ffffff`, `--light: #0f172a`, `--accent: #0891b2`
    - For cards and backgrounds: `--bg-card`, `--header-bg`, `--glass-bg`, `--input-bg`, `--border-light`
  - Organize new styles by section (use existing sections as reference).
  - Use media queries from breakpoints: mobile (480px), tablet (768px), desktop (1200px+).
- **JavaScript**: 
  - Keep it vanilla (no heavy frameworks).
  - Use classes for organization, auto-initialize on `DOMContentLoaded`.
  - Use fetch API for HTTP requests with appropriate error handling.
  - Follow the pattern: Constructor ‚Üí init() ‚Üí other methods.
  - Always handle errors gracefully with try-catch blocks.
  - Use meaningful variable and method names.
- **Adding New Features**:
  - For new HTML elements: Add to `index.html` with semantic tags.
  - For new styles: Add to `assets/css/styles.css` in appropriate section.
  - For new functionality: Create new class in `assets/js/` and initialize on `DOMContentLoaded`.
  - Load new scripts in `index.html` in correct order (after dependencies).
- **Modifying Existing Modules**:
  - **Theme**: Edit `assets/js/theme-manager.js` (logic) and `assets/css/styles.css` (colors in `:root` and `html[data-theme="light"]`).
  - **Menu**: Edit `assets/js/mobile-menu.js` (logic) and search for `.menu-toggle`, `.menu-open`, `.overlay` in `assets/css/styles.css`.
  - **Scroll**: Edit `assets/js/animations.js` (logic and intersection thresholds) and `.hidden`, `.show` classes in `assets/css/styles.css`.
  - **Contact**: Edit `assets/js/contact-form.js` (form logic) and `.contact-form`, `.form-*` classes in `assets/css/styles.css`.
  - **Utilities**: Edit `assets/js/utils.js` (particles config, shapes animation, counter logic).
  - **Visitor Tracking**: Edit `assets/js/geo-counter.js` (coleta de dados, envio para Google Apps Script) and `.views-counter` in `assets/css/styles.css`. Must configure Google Apps Script URL in `GeoViewsCounter.GOOGLE_APPS_SCRIPT_URL`.
- **Python Script (`update_projects.py`)**:
  - Use `requests` library if available, maintain `urllib` fallback for compatibility.
  - Handle API errors gracefully with try-except blocks and informative print statements.
  - Always track downloaded images globally via `downloaded_images` set for git commit.
  - Image selection strategy (in order): README content images ‚Üí social preview ‚Üí org avatar ‚Üí placeholder.
  - Exclude forks and repositories without descriptions from selection.
  - Output timeline HTML with 3-column grid layout for alternating left/right cards.
  - Update copyright year and "√öltima atualiza√ß√£o" timestamp in footer on each run.
  - Only modify content between `<!-- PROJECTS_START -->` and `<!-- PROJECTS_END -->` markers.
- **Responsive Design**: 
  - Use media queries from `assets/css/styles.css` (breakpoints: 480px, 768px, 1200px).
  - Timeline collapses to single column on smaller screens (align items to center).
  - Font sizes scale appropriately for readability.
  - Test on mobile (< 480px), tablet (480-768px), and desktop (> 768px).

## Key Files
- `index.html`: Main entry point. Contains semantic HTML structure (~434 lines).
- `assets/css/styles.css`: Main stylesheet with all CSS (~1000 lines, organized by sections).
- `assets/js/theme-manager.js`: Theme toggling logic (light/dark mode).
- `assets/js/mobile-menu.js`: Mobile menu toggle and overlay handling.
- `assets/js/animations.js`: Scroll animations, intersection observers, smooth scrolling.
- `assets/js/contact-form.js`: Form submission, email utilities, FAB, toast notifications.
- `assets/js/utils.js`: Particles configuration, floating shapes, view counter.
- `assets/js/geo-counter.js`: Visitor tracking (IP, geolocation, timestamp, user-agent collection and Google Drive integration).
- `assets/js/theme.js`: Legacy theme handling (kept for compatibility).
- `GOOGLE_APPS_SCRIPT_CODE.gs`: Google Apps Script backend code for receiving and storing visitor data in Google Sheets.
- `SETUP_GOOGLE_DRIVE_TRACKING.md`: Detailed instructions for configuring Google Apps Script and visitor tracking.
- `update_projects.py`: Automation script to fetch GitHub repos and update project timeline.
